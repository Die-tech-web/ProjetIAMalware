$(document).ready(function() {
    // Charger les options de boutons radio en fonction de l'en-tête du tableau
    var headers = ["AddressOfEntryPoint", "MajorLinkerVersion", "MajorImageVersion", "MajorOperatingSystemVersion", "DllCharacteristics", "SizeOfStackReserve", "NumberOfSections", "ResourceSize", "IfMalware"];
    var radioGroup = $('.form-radio');
    $.each(headers, function(index, value) {
        radioGroup.append(
            '<div class="form-check">' +
                '<input class="form-check-input" type="radio" name="trainingData" id="' + value + '" value="' + value + '">' +
                '<label class="form-check-label" for="' + value + '">' + value + '</label>' +
            '</div>'
        );
    });

    $('#predictionForm').submit(function(event) {
        event.preventDefault(); // Empêcher le formulaire de se soumettre normalement

        // Récupérer la valeur du bouton radio sélectionné
        var trainingData = $('input[name="trainingData"]:checked').val();

        // Envoyer les données au serveur au format JSON
        $.ajax({
            type: 'POST',
            url: '/predict',
            contentType: 'application/json',
            data: JSON.stringify({ 'trainingData': trainingData }),
            success: function(response) {
                // Afficher le résultat de la prédiction
                var results = response.results;
                var tableBody = '';
                for (var model in results) {
                    var accuracy = results[model]['accuracy'];
                    var classificationReport = results[model]['classification_report'];
                    tableBody += '<tr>';
                    tableBody += '<td>' + model + '</td>';
                    tableBody += '<td>' + accuracy + '</td>';
                    tableBody += '<td><pre>' + classificationReport + '</pre></td>';
                    tableBody += '</tr>';
                }
                $('.table tbody').html(tableBody);
                // Mettre en surbrillance le meilleur modèle
                var bestModel = response.best_model;
                $('.table tbody tr').removeClass('best-model');
                $('.table tbody tr:contains("' + bestModel + '")').addClass('best-model');
            },
            error: function(xhr, status, error) {
                console.error('Erreur lors de la prédiction:', error);
            }
        });
    });
});
